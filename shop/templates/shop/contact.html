{% extends 'shop/basic.html' %}
{% block title %} Contact Us - SuperBazer {% endblock %}
{% block contactactive %}active{% endblock contactactive %}
{% block css %}
body, html{
height: 100%;
marrgin: 0;
}
.container-wrapper{
display: flex;
justify-content: center;
align-items: center;
height: 100vh;
}
.fotr{
position: relative;
bottom: -77px;
}
{% endblock %}
{% block body %}
<div class="container-wraper">
    <div class="container my-3 mx-5">
        <h3>Contact Us</h3>
        <form action="/shop/contact/" method="post">
            {% csrf_token %}
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" class="form-control" id="name" name="name" placeholder="Enter Your Name">
            </div>
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" class="form-control" id="email" name="email" placeholder="Enter Your Email">
            </div>
            <div class="form-group">
                <label for="phone">Phone</label>
                <input type="tel" class="form-control" id="phone" name="phone" placeholder="Enter Your Phone Number">
            </div>
            <div class="form-group">
                <label for="desc">How May We Help You?</label>
                <textarea class="form-control" id="desc" name="desc" rows="3"></textarea>
            </div>
            <button type="submit" class="btn btn-success" id="submit">Submit</button>
        </form>
    </div>
</div>
<script>
    // Check if the success query parameter is present
    const urlParms = new URLSearchParams(window.location.search);
    if(urlParms.get("success") === "true"){
        alert("Your message has been sent successfully. We will get back to you soon.");

        // Remove 'success' from URL without reloading
        const newURL = window.location.protocol+"//"+window.location.host+window.location.pathname;
        window.history.replaceState({}, document.title, newURL);
    }
    if (localStorage.getItem('cart') === null){
        cart = {}; 
        }
        else{
        cart = JSON.parse(localStorage.getItem('cart')); // Retrieve the cart from localStorage
        updateCartDisplay(cart)
        }
        function updateCartDisplay(cart) {
        let totalItems = 0;
        for (let item in cart) {
        const qty = parseInt(cart[item].qty);
        if (!isNaN(qty)) {
            totalItems += qty;
        }
        }
        const cartCounter = document.getElementById('cart');
        if (cartCounter) cartCounter.innerHTML = totalItems;
        console.log("Total Items ",totalItems)

    }

    // Back to cart page-
        function sendCartToCartPage() {
            const cart_data = localStorage.getItem("cart");

            fetch("/shop/cart/", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-CSRFToken": getCSRFToken(),
                },
                body: JSON.stringify({cart_data})
            })
            .then(response => response.json())
            .then(data => {
                window.location.href = "/shop/cart/"; // go to cart page
            })
            .catch(error => {
                console.error("Error sending cart to backend:", error);
            });
        }

        function getCSRFToken() {
            const csrfInput = document.querySelector('meta[name=csrf-token]');
            return csrfInput ? csrfInput.content : '';
        }
</script>
{% endblock %}